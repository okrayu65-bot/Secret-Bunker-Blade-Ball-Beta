-- Remote Hook (Minimal)
local revertedRemotes={}
local function isValidRemoteArgs(a)return #a==7 and type(a[2])=="string"and type(a[3])=="number"and typeof(a[4])=="CFrame"and type(a[5])=="table"and type(a[6])=="table"and type(a[7])=="boolean"end
local function hookRemote(r)if not revertedRemotes[r]then local m=getrawmetatable(r);setreadonly(m,false);local o=m.__index;m.__index=function(s,k)if k=="FireServer"and s:IsA("RemoteEvent")then return function(_,...)local a={...};if isValidRemoteArgs(a)then revertedRemotes[s]=a end;return o(s,"FireServer")(_,unpack(a))end end;return o(s,k)end;setreadonly(m,true)end end
for _,r in game.ReplicatedStorage:GetDescendants()do if r:IsA("RemoteEvent")then hookRemote(r)end end
game.ReplicatedStorage.DescendantAdded:Connect(function(c)if c:IsA("RemoteEvent")then hookRemote(c)end end)

local capturedRemote,capturedArgs
spawn(function()repeat task.wait(0.5)until next(revertedRemotes)for r,a in revertedRemotes do if isValidRemoteArgs(a)then capturedRemote=r;capturedArgs=a;break end end end)

local lastFire=0
local cooldown=0.166 -- NO DOUBLE: 166ms Safe (2025 Std)
local predThresh=0.23

local function fireParry()
    if tick()-lastFire<cooldown then return end
    lastFire=tick()
    if capturedRemote then capturedRemote:FireServer(unpack(capturedArgs))end
end

-- Services/Cache
local RS,Players,Stats,lp,Balls=game:GetService("RunService"),game:GetService("Players"),game:GetService("Stats"),Players.LocalPlayer,workspace:WaitForChild("Balls")
local currentBall=nil;local prevTime=math.huge

-- Elite Ball Tracker
Balls.ChildAdded:Connect(function(b)if b:IsA("BasePart")and b:GetAttribute("realBall")and b:GetAttribute("target")==lp.Name then currentBall=b end end)
Balls.ChildRemoved:Connect(function(b)if currentBall==b then currentBall=nil end end)
Balls:GetAttributeChangedSignal("target"):Connect(function()-- Fallback
    for _,b in Balls:GetChildren()do if b:IsA("BasePart")and b:GetAttribute("realBall")and b:GetAttribute("target")==lp.Name then currentBall=b;break end end
end)

-- SINGLE Loop (Max Perf)
local mainConn;local autoParryOn=false;local autoSpamOn=false
local function startMainLoop()if mainConn then return end;mainConn=RS.Heartbeat:Connect(function()
    local char=lp.Character;if not char or not char:FindFirstChild("Head")then return end;local head=char.Head
    if not currentBall or currentBall.AssemblyLinearVelocity.Magnitude<25 then prevTime=math.huge;return end
    local dist=(currentBall.Position-head.Position).Magnitude
    local vel=currentBall.AssemblyLinearVelocity
    local dirDot=vel.Unit:Dot((head.Position-currentBall.Position).Unit)
    local ping=Stats.Network.ServerStatsItem["Data Ping"]:GetValue()/1000
    local thresh=predThresh+(ping*1.8)
    if vel.Magnitude>90 then thresh=thresh*0.9 end
    local timeToHit=dist/vel.Magnitude
    -- Auto Parry: STRICT Single (Skip <7.5, Dir>0.72, Dec*0.92)
    if autoParryOn and dist>7.5 and dirDot>0.72 and timeToHit<=thresh and timeToHit<prevTime*0.92 then
        fireParry();prevTime=timeToHit
    else
        prevTime=timeToHit
    end
    -- Clash: 1/CD Only (dist<=10)
    if autoSpamOn and dist<=10 then fireParry()end
end)end
local function stopMainLoop()if mainConn then mainConn:Disconnect();mainConn=nil end;prevTime=math.huge end

local function toggleAutoParry(state)autoParryOn=state;if state or autoSpamOn then startMainLoop()else stopMainLoop()end end
local function toggleAutoSpam(state)autoSpamOn=state;if state or autoParryOn then startMainLoop()else stopMainLoop()end end

local function manualSpam()for _=1,35 do fireParry();task.wait(0.03)end end

-- WindUI
local WindUI=loadstring(game:HttpGet("https://raw.githubusercontent.com/Footagesus/WindUI/main/dist/main.lua"))()
local Window=WindUI:CreateWindow({Title="Secret Bunker",Folder="SecretBunker",IconSize=44,NewElements=true,OpenButton={Title="Open Secret Bunker ⚔️",CornerRadius=UDim.new(1,0),StrokeThickness=3,Enabled=true},Topbar={Height=44,ButtonsType="Mac"}})
local CombatTab=Window:Tab({Title="⚔️ Combat",Desc="NO DOUBLE PARRY 100% – 166ms Safe",Icon="solar:sword-bold",IconColor=Color3.fromHex("#FF6B6B")})
local ParrySec=CombatTab:Section({Title="Parry Features"})
ParrySec:Toggle({Title="Auto Parry (Strict Elite)",Callback=toggleAutoParry,Flag="AutoParry"})
ParrySec:Toggle({Title="Clash Spam (1/166ms Safe)",Callback=toggleAutoSpam,Flag="AutoSpam"})
ParrySec:Slider({Title="Pred Thresh",Min=0.18,Max=0.35,Default=0.23,Rounding=2,Callback=function(v)predThresh=v end,Flag="PredThresh"})
ParrySec:Slider({Title="CD (No Double – 0.166 Safe)",Min=0.14,Max=0.25,Default=0.166,Rounding=3,Callback=function(v)cooldown=v end,Flag="Cooldown"})
ParrySec:Button({Title="Manual Spam (x35 Safe)",Callback=manualSpam})
ParrySec:Button({Title="Unload",Callback=function()toggleAutoParry(false);toggleAutoSpam(false);Window:Destroy()end})
WindUI:Notify({Title="NO DOUBLE PARRY 100%",Content="166ms Global CD + Strict Dec*0.92/Dir>0.72/Skip<7.5 = ZERO DOUBLE DEATHS. Tune CD>0.16 safe. F once."})
