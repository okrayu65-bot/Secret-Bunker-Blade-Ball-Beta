-- Secret Bunker EMERGENCY PARRY (MOUSE CLICK 2025 FIX)
-- VIM Left Click + realBall/target + 0.55 TTI | WindUI

local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/Footagesus/WindUI/main/dist/main.lua"))()
local Window = WindUI:CreateWindow({Title = "Secret Bunker", TitleIcon = "rbxassetid://4483345998"})

local CombatTab = Window:Tab({Name = "Combat", Icon = "sword"})
local VisualTab = Window:Tab({Name = "Visuals", Icon = "eye"})
local PlayerTab = Window:Tab({Name = "Player", Icon = "user"})
local MiscTab = Window:Tab({Name = "Misc", Icon = "settings"})

local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")
local VirtualInputManager = game:GetService("VirtualInputManager")
local Player = Players.LocalPlayer

local Balls = Workspace:WaitForChild("Balls")

getgenv().AutoParry = false
getgenv().AutoSpam = false
getgenv().BallESP = false
getgenv().WalkSpeed = 16
getgenv().JumpPower = 50

-- FIXED ESP
local function AddESP(ball)
    if ball:FindFirstChild("ESP") then return end
    local hl = Instance.new("Highlight", ball)
    hl.Name = "ESP"
    hl.FillColor = Color3.new(1,0,0)
    hl.OutlineColor = Color3.new(1,1,1)
    hl.FillTransparency = 0.3
    hl.OutlineTransparency = 0
    local bill = Instance.new("BillboardGui", ball)
    bill.Name = "ESP"
    bill.Size = UDim2.new(0,100,0,50)
    bill.StudsOffset = Vector3.new(0,3,0)
    bill.AlwaysOnTop = true
    local txt = Instance.new("TextLabel", bill)
    txt.Size = UDim2.new(1,0,1,0)
    txt.BackgroundTransparency = 1
    txt.Text = "BALL -> YOU"
    txt.TextColor3 = Color3.new(1,0,0)
    txt.TextStrokeTransparency = 0
    txt.Font = Enum.Font.GothamBold
    txt.TextScaled = true
end

local function RemoveESP(ball)
    pcall(function()
        ball:FindFirstChild("ESP", true):Destroy()
    end)
end

-- Get Real Ball
local function GetBall()
    for _, ball in pairs(Balls:GetChildren()) do
        if ball:GetAttribute("realBall") then return ball end
    end
end

-- ULTIMATE PARRY LOOP (VIM CLICK)
spawn(function()
    while task.wait() do
        if getgenv().AutoParry then
            local ball = GetBall()
            local char = Player.Character
            if ball and char and char:FindFirstChild("HumanoidRootPart") then
                local root = char.HumanoidRootPart
                local dist = (ball.Position - root.Position).Magnitude
                local speed = ball.zoomies.VectorVelocity.Magnitude
                if ball:GetAttribute("target") == Player.Name and dist / speed <= 0.55 then
                    VirtualInputManager:SendMouseButtonEvent(0,0,0,true,game,0)
                    task.wait(0.01)
                    VirtualInputManager:SendMouseButtonEvent(0,0,0,false,game,0)
                    if getgenv().AutoSpam then
                        for i=1,3 do
                            task.wait(0.001)
                            VirtualInputManager:SendMouseButtonEvent(0,0,0,true,game,0)
                            task.wait(0.001)
                            VirtualInputManager:SendMouseButtonEvent(0,0,0,false,game,0)
                        end
                    end
                end
            end
        end
    end
end)

-- Combat
CombatTab:Toggle({Title = "Auto Parry (MOUSE CLICK FIX)", Default=false, Callback=function(v) getgenv().AutoParry = v end})
CombatTab:Toggle({Title = "Auto Spam (Multi Click)", Default=false, Callback=function(v) getgenv().AutoSpam = v end})

-- Visuals
VisualTab:Toggle({Title = "Ball ESP", Default=false, Callback=function(v)
    getgenv().BallESP = v
    if v then
        Balls.ChildAdded:Connect(function(child) task.wait(0.1); AddESP(child) end)
        for _,b in Balls:GetChildren() do AddESP(b) end
    else
        for _,b in Balls:GetChildren() do RemoveESP(b) end
    end
end})

-- Player
PlayerTab:Slider({Title="WalkSpeed", Min=16, Max=200, Default=16, Callback=function(v)
    getgenv().WalkSpeed = v
    if Player.Character then Player.Character.Humanoid.WalkSpeed = v end
end})
PlayerTab:Slider({Title="JumpPower", Min=50, Max=200, Default=50, Callback=function(v)
    getgenv().JumpPower = v
    if Player.Character then Player.Character.Humanoid.JumpPower = v end
end})

Player.CharacterAdded:Connect(function(char)
    char:WaitForChild("Humanoid").WalkSpeed = getgenv().WalkSpeed
    char:WaitForChild("Humanoid").JumpPower = getgenv().JumpPower
end)

-- Misc
MiscTab:Button({Title="Infinite Yield", Callback=function() loadstring(game:HttpGet("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source"))() end})

CombatTab:Label("MOUSE CLICK SIM = UNPATCHABLE | TURN ON AUTO PARRY NOW")

WindUI:Notify("EMERGENCY FIX LOADED", "CLICK SIM PARRY ACTIVE - MOM SAFE!")
